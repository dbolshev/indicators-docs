######################################################################################################################################################
RISK1-15. Використання замовником переговорної процедури закупівлі за відсутності законодавчих підстав (Дозакупівля проводиться за відсутності первинної закупівлі у даного постачальника)
######################################################################################################################################################

***************
Суть індикатора
***************

Індикатор свідчить про: 
Замовник обрав проведення переговорної процедури закупівлі згідно з п.5 ч.2 ст.35 Закону, однак попередньо:
не робив закупівлю у даного постачальника за вказаним кодом предмету закупівлі.

************************************
Законодавче обґрунтування індикатора
************************************

Стаття 35. Умови застосування переговорної процедури закупівлі
частина 2. Переговорна процедура закупівлі застосовується замовником як виняток у разі:
пункт 5) потреби здійснити додаткову закупівлю в того самого постачальника з метою уніфікації, стандартизації або забезпечення сумісності з наявними товарами, технологіями, роботами чи послугами, якщо заміна попереднього постачальника (виконавця робіт, надавача послуг) може призвести до несумісності або виникнення проблем технічного характеру, пов’язаних з експлуатацією та обслуговуванням

********************************
Підстава для розробки індикатора
********************************

Свідчить про ймовірне порушення вимог частини другої статті 35 Закону в частині відсутності підстави для проведення переговорної процедури закупівлі;
Автоматичний контроль для запобігання проведення переговорної процедури з порушенням п.4 ч.2 ст.35 не реалізовано на рівні системи електронних публічних закупівель;
Система публічних закупівель генерує достатньо даних в задовільній якості для можливості реалізації цього індикатора та його спрацювання з задовільної чистотою.
Узгоджено з Держаудит службою; 

*********************************
Методологія та алгоритм розрахунку індикатора
*********************************

Етап існування процедури
========================
Індикатор розраховується, коли процедура знаходиться на етапі *тендерингу*.


Рівень розрахунку
=================
Індикатор розраховується для переговорних процедур на рівні *тендера*.

Джерела даних для розрахунку
============================

Для розрахунку індикатора використовуються наступні джерела даних:

- API модуля тендеринга електронної системи закупівель
- Таблиця розрахункових даних для активних переговорних процедур на дату розрахунку індикатора. Зібрані розрахункові дані включать: предмет закупівлі відповідно до трансакційної змінної :ref:`tv_subjectOfProcurement` та ідентифікатор замовника відповідно до транзакційної змінної :ref:`tv_procuringEntity`

- Аналітична таблиця :ref:`tbl_PESupplierCPV4`, у якій зберігаються дані про попередні закупки: з кожної здійсненої закупівлі вибираємо ідентификатор замовника, ідентификатор постачальника та код предмету закупівлі, що замовник придбав у постачальника.

Типи процедур
=============

Індикатор розраховується для наступних типів процедур:

- ``negotiation`` - *переговорна процедура*
- ``negotiation.quick`` - *прискорена переговорна процедура*


Типи замовників
===============

Індикатор розраховується для замовників які в системі визначені як "А — Замовник (загальний)"  -  (``general``) та "В — Замовник, що діє в окремих сферах господарювання (спеціальний)"  -  (``special``).

Стадії процедур
===============

Подія, що вмикає розрахунок індикатора
--------------------------------------

Подія, що вмикає розрахунок індикатора - з'являється переговорна процедура зі статосум ``active``.

Подія, що вимикає розрахунок індикатора
---------------------------------------

Розрахунок індикатора вимикається одразу після того, як останнє обчислене його значення дорівнює ``0`` чи ``1``.

Статуси процедур
----------------

Виходячи з подій, що вмикають та вимикають розрахунок індикатора, маємо наступні умови розрахунку:

- Індикатор розраховується, якщо статус процедури дорівнює ``active`` та не виконана умова вимикання розрахунку.


Частота розрахунку
==================

Якщо виконані умови для розрахунку індикатора, він розраховується при кожній зміні json-документа а також один раз на добу незалежно від наявності змін у json-документі.

Поля для розрахунку
===================

Для розрахунку індикатора використовуються наступні поля з API модуля тендеринга:

- ``data.suppliers.identifier.id``
- ``data.suppliers.identifier.scheme``
- ``data.cause``
- ``data.contracts``
- ``data.contracts.status``

Для розрахунку індикатора використовуються наступні транзакційні змінні:

- :ref:`tv_subjectOfProcurement`
- :ref:`tv_procuringEntity`

Для розрахунку індикатора використовуються наступні аналітичні таблиці:

- :ref:`tbl_PESupplierCPV4`

Формула розрахунку
==================

Індикатор розраховується наступним чином:

Якщо причина ``data.cause`` вказана не як ``additionalPurchase``, тобто "дозакупка у одного постачальника", індикатор приймає значення ``-2``, розрахунок завершується.

Перевіряємо, чи Замовник опублікував рішення про намір укласти договір та вніс інформацію про учасників та визначив Переможця переговорів. У електронній системі закупівель цій події відповідає поява об'єкту ``data.contracts`` зі статусом ``data.contracts.status = 'pending'``. 

Якщо об'єкту немає, то індикатор приймає значення ``-2`` та обчислення завершується.

Якщо такий документ є та причина ``data.cause`` вказана як ``additionalPurchase``, переходимо на наступний крок.

Алгоритм спочaтку генерує інформацію яка необхідна для розрахунку індикатора в аналітичні таблиці за один операційний день, що минув. 

1. Для замовника який здійснює переговорну процедуру з метою дозакупки процедур :ref:`tv_procuringEntity` та предмета закупівлі :ref:`tv_subjectOfProcurement` у аналітичній таблиці :ref:`tbl_PESupplierCPV4` шукається хоча б одна процедура, де співпаде ідентификатор замовника, ідентификатор постачальника, а :ref:`tv_subjectOfProcurement` переговорної процедури співпаде з :ref:`tv_subjectOfProcurement` знайденої процедури.

2. Якщо в аналітичній таблиці знайдена хоча б одна така процедура, то індикатор приймає значення ``0``.

3. Якщо в аналітичній таблиці не знайдено жодної процедури, індикатор приймає значення ``1``.

Фактори, що впливають на неточність розрахунку
==============================================

1. Індикатор може бути спрацьований некоректно у випадках, коли юридичні особи, які не є замовниками в розумінні Закону, але є державними, комунальними, казенними підприємствами, господарськими товариствами чи об'єднаннями підприємств, в яких державна чи комунальна частка складає 50 і більше відсотків  помилково визначають себе в системі як загальні замовники. Така ситуація відбувається з причини, що за чинними нормативними актами, замовник при ініціюванні процедури закупівлі самостійно у полі "тип замовника" себе визначає. При цьому, з боку системи чи авторизованих майданчиків не здійснюється контроль за достовірність такого визначення. Таким чино індикатор спрацьовує на тих процедурах які в системі зазначено як замовник - загальний, а по факту замовник належить до категорії "інші".

2. У п'ятому пункті частини 1 статті 35 Закону України "Про публічні закупівлі" та в відповідних нормативних актах, чітко не вказано часовий проміжок, в якому мають знаходитисяпопередні процедури, щоб це могло служити приводом для проведення переговорної процедури. Було прийняте рішення в якості часового проміжку брати проміжок від поточної дати до початку 2016 року.
