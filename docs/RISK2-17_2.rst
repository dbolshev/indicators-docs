==========================================================================================================================================================================================================================
RISK2-17-2п. "Учасника з найбільш економічно вигідною пропозицією замовником відхиллено, а переможцем визначено учасника-ФОП, з яким такий замовник попередньо укладав договори більше ніж по 3-м різним групам CPV".
==========================================================================================================================================================================================================================


***************
Суть індикатора
***************

Замовник ймовірно неправомірно відхиляє найбільш економічно вигідну тендерну пропозицію учасника та визначає переможцем іншого учасника.

************************************
Законодавче обґрунтування індикатора
************************************

Свідчить про ймовірне порушення вимог частини першої статті 30 Закону в частині неправомірного відхилення тендерної пропозиції учасника з найбільш економічно вигідною пропозицією.

********************************
Підстава для розробки індикатора
********************************

Цей індикатор було розроблено для виявлення можливої змови Замовника з учасником.

*********************************
Методологія розрахунку індикатора
*********************************

Досліджуються відкриті надпорогові процедури, що мають дискваліфікації. Якщо в лоті, де були дискваліфікації переможцем було обрано учасника ФОП, що має укладені контракти із замовником по 3 і більше різних видах продукції, індикатор спрацьовує.


Етап існування процедури
========================
Індикатор розраховується, коли процедура знаходиться на етапі *тендерингу*.



Рівень розрахунку
=================
Індикатор розраховується на рівні *лоту*.

Джерела даних для розрахунку
============================

Для розрахунку індикатора вікористовуються наступні джерела даних:

- API модуля тендеринга електронної системи закупівель
- аналітична таблиця :ref:`tbl_supplierForPEWith3CPV`

Типи процедур
=============

Індикатор розраховується для наступних типів процедур:

- ``aboveThresholdUA`` - *відкриті торги*
- ``aboveThresholdEU`` - *відкриті торги з публікацією англійською мовою*

Типи замовників
===============

Індикатор розраховується для загальних замовників (``general``) та (``special``).


Стадії процедур
===============

Подія, що вмикає розрахунок індикатора
--------------------------------------

Подія, що вмикає розрахунок індикатора - перехід процедури у статус ``active.qualification``.

Подія, що вимикає розрахунок індикатора
---------------------------------------

Подія, що вмикає розрахунок індикатора - перехід процедури у статус ``complete``.


Статуси процедур
----------------

Виходячи з подій, що вмикають та вимикають розрахунок індикатора, маємо наступні умови розрахунку:

- Індикатор розраховується на наступні статуси процедур:
  
   - ``active.qualification``
   - ``active.awarded``

Частота розрахунку
==================

Якщо виконані умови для розрахунку індикатора, він розраховується при кожній зміні json-документа а також один раз на добу незалежно від наявності змін у json-документі.

Поля для розрахунку
===================

Для розрахунку індикатора використовуються наступні поля з API модуля тендеринга:

- ``data.procuringEntity.identifier.scheme``
- ``data.procuringEntity.identifier.id``
- ``data.awards.status``
- ``data.awards.lotID``
- ``data.awards.bid_id``
- ``data.lots.id``
- ``data.bids.id``
- ``data.bids.tenderers.identifier.scheme``
- ``data.bids.tenderers.identifier.id``

Формула розрахунку
==================

Якщо в лоті немає дискваліфікацій, тобто на лот через ``data.awards.lotID = data.lots.id`` не послилається жоден об'єкт ``data.awards``, що має статус ``data.awards.status = 'unsuccessful'``, індикатор приймає значення ``-2``. Розрахунок завершується.

Якщо в лоті не визначено переможця, тобто на лот через ``data.awards.lotID = data.lots.id`` не послилається жоден об'єкт ``data.awards``, що має статус ``data.awards.status = 'active'``, індикатор приймає значення ``-2``. Розрахунок завершується.

Якщо в лоті є хоча б одна дискваліфікація та визначено переможця, переходимо на наступний крок.

1. Визначаємо переможця лота. З блоку ``data.awards``, що має ``data.awards.status = 'active'`` та посилається на лот через ``data.awards.lotID = data.lots.id`` знаходимо переможну пропозицію ``data.bids``, де ``data.bids.id = data.awards.bid_id``.

2. Зі знайденого блоку ``data.bids`` знаходимо ідентифікатор переможця - конкатенація ``data.bids.tenderers.identifier.scheme`` та ``data.bids.tenderers.identifier.id``.

3. Якщо ``data.bids.tenderers.identifier.scheme != 'UA-EDR'`` або довжина ``data.bids.tenderers.identifier.id`` не дорівнює 10 символам, індикатор приймає значення ``0``, розрахунок завершується.

4. Якщо ``data.bids.tenderers.identifier.scheme == 'UA-EDR'`` та довжина ``data.bids.tenderers.identifier.id`` дорівнює 10 символам, переходимо на наступний крок.

5. Визначаємо замовника процедури - конкатенація ``data.procuringEntity.identifier.scheme`` та ``data.procuringEntity.identifier.id``.

6. Якщо для ідентифікатора замовника та ідентифікатора переможця знаходиться рядок в таблиці :ref:`tbl_supplierForPEWith3CPV` та кількість CPV у рядку більше або рівне 3, індикатор приймає значення  ``1``. Якщо такого рядка немає або кількість CPV у рядку менше за 3, індикатор приймає значення ``0``.

Фактори, що впливають на неточність розрахунку
==============================================

1. Індикатор може бути порахований неточно у випадках, коли замовники в окремих сферах господарювання і організації, що не є замовниками, помилково визначають себе в системі як загальні замовники.

2. Індикатор може бути порахований неточно у випадках, коли замовником неправильно визначено тип процедури.
