######################################################################################################################################################
RISK-1-1. Використання замовником переговорної процедури закупівлі за відсутності законодавчих підстав (Переговорна процедура проведена за відсутності двох неуспішних процедур)
######################################################################################################################################################

***************
Суть індикатора
***************

Індикатор свідчить про: 
Замовник обрав проведення переговорної процедури закупівлі згідно з п.4 ч.2 ст.35 Закону, однак попередньо:
1) не відмінив двічі тендер (предмет закупівлі та сума очікуваної вартості аналогічні до переговорної процедури закупівлі) через відсутність достатньої кількості учасників; 
2) відмінив двічі тендер, предмет закупівлі якого, його технічні та якісні характеристики, а також вимоги до учасника відрізняються від вимог, що були визначені замовником у тендерній документації.

************************************
Законодавче обґрунтування індикатора
************************************

Стаття 35. Умови застосування переговорної процедури закупівлі
частина 2. Переговорна процедура закупівлі застосовується замовником як виняток у разі:
пункт 4) якщо замовником було двічі відмінено тендер через відсутність достатньої кількості учасників, при цьому предмет закупівлі, його технічні та якісні характеристики, а також вимоги до учасника не повинні відрізнятися від вимог, що були визначені замовником у тендерній документації;

********************************
Підстава для розробки індикатора
********************************

Свідчить про ймовірне порушення вимог частини другої статті 35 Закону в частині відсутності підстави для проведення переговорної процедури закупівлі;
Автоматичний контроль для запобігання проведення переговорної процедури з порушенням п.4 ч.2 ст.35 не реалізовано на рівні системи електронних публічних закупівель;
Система публічних закупівель генерує достатньо даних в задовільній якості для можливості реалізації цього індикатора та його спрацювання з задовільної чистотою.
Узгоджено з Держаудит службою; 

*********************************
Методологія та алгоритм розрахунку індикатора
*********************************

Етап існування процедури
========================
Індикатор розраховується, коли процедура знаходиться на етапі *тендерингу*.


Рівень розрахунку
=================
Індикатор розраховується для переговорних процедур на рівні *тендера*.

Джерела даних для розрахунку
============================

Для розрахунку індикатора використовуються наступні джерела даних:

- API модуля тендеринга електронної системи закупівель
- Таблиця розрахункових даних для активних переговорних процедур на дату розрахунку індикатора. Зібрані розрахункові дані включать: предмет закупівлі відповідно до трансакційної змінної :ref:`tv_tenderCPVList` та ідентифікатор замовника відповідно до транзакційної змінної :ref:`tv_procuringEntity`

- Аналітична таблиця :ref:`tbl_unsuccessfulAbove` відмінених (неуспішних) тендерних процедур для всіх замовників, які ініціюють переговорну процедуру (активний статус) на дату розрахунку. Відмінені (неуспішні) процедури відбираються наступним чином - пошук відмінених процедур здійснюються для замовника за період в зворотному напрямку від дати ініціації переговорної процедури на яку розраховується індикатор до першої попередньої переговорної процедури, якщо попередньої процедури в проміжку 365 днів не знайдено, таким чином пошук процедур відбувається за період 365 днів від дати переговорної процедури яка досліджується.

Типи процедур
=============

Індикатор розраховується для наступних типів процедур:

- ``negotiation`` - *переговорна процедура*
- ``negotiation.quick`` - *прискорена переговорна процедура*


Типи замовників
===============

Індикатор розраховується для замовників які в системі визначені як "А — Замовник (загальний)"  -  (``general``) та "В — Замовник (спеціальний)"  -  (``special``).

Стадії процедур
===============

Подія, що вмикає розрахунок індикатора
--------------------------------------

Подія, що вмикає розрахунок індикатора - з'являється переговорна процедура зі статосум ``active``.

Подія, що вимикає розрахунок індикатора
---------------------------------------

Розрахунок індикатора вимикається одразу після того, як останнє обчислене його значення дорівнює ``0`` чи ``1``.

Статуси процедур
----------------

Виходячи з подій, що вмикають та вимикають розрахунок індикатора, маємо наступні умови розрахунку:

- Індикатор розраховується, якщо статус процедури дорівнює ``active`` та не виконана умова вимикання розрахунку.


Частота розрахунку
==================

Якщо виконані умови для розрахунку індикатора, він розраховується при кожній зміні json-документа а також один раз на добу незалежно від наявності змін у json-документі.

Поля для розрахунку
===================

Для розрахунку індикатора використовуються наступні поля з API модуля тендеринга:

- ``value:amount``
- ``data.cause``
- ``data.contracts``
- ``data.contracts.status``

Для розрахунку індикатора використовуються наступні транзакційні змінні:

- :ref:`tv_tenderCPVList`
- :ref:`tv_procuringEntity`

Для розрахунку індикатора використовуються наступні аналітичні таблиці:

- :ref:`tbl_unsuccessfulAbove`

Формула розрахунку
==================

Індикатор розраховується наступним чином:

Якщо причина ``data.cause`` вказана не як ``twiceUnsuccessful``, тобто "двічі відмінена відкрита процедура", індикатор приймає значення ``-2``, розрахунок завершується.

Перевіряємо, чи Замовник опублікував рішення про намір укласти договір та вніс інформацію про учасників та визначив Переможця переговорів. У електронній системі закупівель цій події відповідає поява об'єкту ``data.contracts`` зі статусом ``data.contracts.status = 'pending'``. 

Якщо об'єкту немає, то індикатор приймає значення ``-2`` та обчислення завершується.

Якщо такий документ є та причина ``data.cause`` вказана як ``twiceUnsuccessful``, переходимо на наступний крок.

Алгоритм спочaтку генерує інформацію яка необхідна для розрахунку індикатора в аналітичні таблиці за один операційний день, що минув. 

1. Для замовника який здійснює переговорну процедуру з причини двох неуспішних відкритих процедур:ref:`tv_procuringEntity` та предмета закупівлі або частин предмету закупівлі:ref:`tv_tenderCPVList` у аналітичній таблиці :ref:`tbl_unsuccessfulAbove` шукається відповідна кількість неуспішних відкритих процедур від дати переговорної процедури, яка аналізується, до дати попередньої переговорної процедури цього замовника по даному (або частин) предмету закупівлі. Якщо в проміжку від дати переговорної процедури на протязі 365 днів не відбувалися переговорні процедури цього замовника, пошук відповідної кількості неуспішних відкритих процедур по тому ж предмету закупівлі здійснюється в проміжок 365 днів.

2. Якщо знайдена у аналітичній таблиці кількість неуспішних відкритих процедур замовника по аналогічному предмету закупівлі (або частини предмету закупівлі) більше або дорівнює 2, то індикатор приймає значення ``0``.

3. Якщо знайдена у аналітичній таблиці кількість неуспішних відкритих процедур замовника по аналогічному предмету закупівлі (або частин предмету закупівлі) менше 2 або запис для цього замовника по цоьму предмету закупівлі взагалі не знайдено, то індикатор приймає значення ``1``.

Фактори, що впливають на неточність розрахунку
==============================================

1. Індикатор може бути спрацьований некоректно у випадках, коли юридичні особи, які не є замовниками в розумінні Закону, але є державними, комунальними, казенними підприємствами, господарськими товариствами чи об'єднаннями підприємств, в яких державна чи комунальна частка складає 50 і більше відсотків  помилково визначають себе в системі як загальні замовники. Така ситуація відбувається з причини, що за чинними нормативними актами, замовник при ініціюванні процедури закупівлі самостійно у полі "тип замовника" себе визначає. При цьому, з боку системи чи авторизованих майданчиків не здійснюється контроль за достовірність такого визначення. Таким чино індикатор спрацьовує на тих процедурах які в системі зазначено як замовник - загальний, а по факту замовник належить до категорії "інші".

2. У четвертому пункті частини 1 статті 35 Закону України "Про публічні закупівлі" та в відповідних нормативних актах, чітко не вказано часовий проміжок, в якому мають знаходитися відмінені відкриті процедури, щоб це могло служити приводом для проведення переговорної процедури. Було прийняте рішення в якості часового проміжку брати проміжок від поточної дати до дати, що передує поточній на 1 рік, або до дати проведення попередньої переговорної процедури даного замовника по даному предмету закупівлі.

3. Індикатор може спрацьовувати некоректно в частині застосування порогів для робіт товарів та послуг в CPV 45. На разі закупівлі з CPV 45 вважаються як "роботи". Також цей код CPV може містити послуги з поточного ремонту, таким чином мають бути застосовані відповідні пороги та інші норми закону. Таке розподілення не являється точним. В додаток, алгоритми розрахунку індикаторів будуть застосовувати пороги релевантні для "робіт" таким чином на масив процедур які по своїй сутті являються послугами індикатори розраховуватися не будуть. Відповідно невиявлений ризик порушень та зловживань в даних процедурах. 
